---
layout: main
---
<article class="article-page">
  <div class="page-content">
    {% if page.imgText %}
    <div class="page-cover-image">
      <figure>
        <img class="page-image" src={{ "/assets/img/" | prepend: site.baseurl | append : page.imgText}} alt="{{page.title}}">
        {% if page.fig-caption %}
          <figcaption>{{page.fig-caption}}</figcaption>
        {% endif %}
      </figure>
    </div> <!-- End Page Cover Image -->
    {% else %}
    {% endif %}
    <div class="wrap-content">
      <header class="header-page">
        <h1 class="page-title">{{page.title}}</h1>
        <div class="page-date"><span>{{page.date | date: '%Y, %b %d'}}&nbsp;&nbsp;&nbsp;&nbsp;</span></div>
      </header>
      {{content | markdownify}}
      <div class="page-footer">
        <div class="page-share">
          <a href="https://twitter.com/intent/tweet?text={{ page.title }}&url={{ site.url }}{{ page.url }}" title="Share on Twitter" rel="nofollow" target="_blank">Twitter</a>
          <a href="https://facebook.com/sharer.php?u={{ site.url }}{{ page.url }}" title="Share on Facebook" rel="nofollow" target="_blank">Facebook</a>
          <a href="https://plus.google.com/share?url={{ site.url }}{{ page.url }}" title="Share on Google+" rel="nofollow" target="_blank">Google+</a>
        </div>
        <div class="page-tag">
          {% for tag in page.tags %}
            <a href="{{site.baseurl}}/tags#{{tag}}" class="tag">&#35; {{ tag }}</a>
          {% endfor %}
        </div>
      </div>
      {% include disqus.html %}
    </div> <!-- End Wrap Content -->
  </div> <!-- End Page Content -->
  <div id="directory-content" class="directory-content">
    <div id="directory"></div>
  </div>
  <script>
      <!--js 实现 书签树-->
      var postDirectoryBuild = function() {
          var postChildren = function children(childNodes, reg) {
                  var result = [],
                      isReg = typeof reg === 'object',
                      isStr = typeof reg === 'string',
                      node, i, len;
                  for (i = 0, len = childNodes.length; i < len; i++) {
                      node = childNodes[i];
                      if ((node.nodeType === 1 || node.nodeType === 9) &&
                          (!reg ||
                          isReg && reg.test(node.tagName.toLowerCase()) ||
                          isStr && node.tagName.toLowerCase() === reg)) {
                          result.push(node);
                      }
                  }
                  return result;
              },
              createPostDirectory = function(article, directory, isDirNum) {
                  var contentArr = [],
                      titleId = [],
                      levelArr, root, level,
                      currentList, list, li, link, i, len;
                  levelArr = (function(article, contentArr, titleId) {
                      var titleElem = postChildren(article.childNodes, /^h\d$/),
                          levelArr = [],
                          lastNum = 1,
                          lastRevNum = 1,
                          count = 0,
                          guid = 1,
                          id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                          lastRevNum, num, elem;
                      while (titleElem.length) {
                          elem = titleElem.shift();
                          contentArr.push(elem.innerHTML);
                          num = +elem.tagName.match(/\d/)[0];
                          if (num > lastNum) {
                              levelArr.push(1);
                              lastRevNum += 1;
                          } else if (num === lastRevNum ||
                              num > lastRevNum && num <= lastNum) {
                              levelArr.push(0);
                              lastRevNum = lastRevNum;
                          } else if (num < lastRevNum) {
                              levelArr.push(num - lastRevNum);
                              lastRevNum = num;
                          }
                          count += levelArr[levelArr.length - 1];
                          lastNum = num;
                          elem.id = elem.id || (id + guid++);
                          titleId.push(elem.id);
                      }
                      if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;
                      return levelArr;
                  })(article, contentArr, titleId);
                  currentList = root = document.createElement('ul');
                  dirNum = [0];
                  for (i = 0, len = levelArr.length; i < len; i++) {
                      level = levelArr[i];
                      if (level === 1) {
                          list = document.createElement('ul');
                          if (!currentList.lastElementChild) {
                              currentList.appendChild(document.createElement('li'));
                          }
                          currentList.lastElementChild.appendChild(list);
                          currentList = list;
                          dirNum.push(0);
                      } else if (level < 0) {
                          level *= 2;
                          while (level++) {
                              if (level % 2) dirNum.pop();
                              currentList = currentList.parentNode;
                          }
                      }
                      dirNum[dirNum.length - 1]++;
                      li = document.createElement('li');
                      link = document.createElement('a');
                      link.href = '#' + titleId[i];
                      link.title = '访问' + titleId[i];
                      link.title = '访问' + titleId[i];
                      link.innerHTML = !isDirNum ? contentArr[i] :
                          dirNum.join('.') + ' ' + contentArr[i] ;
                      li.appendChild(link);
                      currentList.appendChild(li);
                  }
                  directory.appendChild(root);
              };
          createPostDirectory(document.getElementsByClassName('wrap-content')[0],document.getElementById('directory'), true);
      };
      postDirectoryBuild();
  </script>

</article> <!-- End Article Page -->
